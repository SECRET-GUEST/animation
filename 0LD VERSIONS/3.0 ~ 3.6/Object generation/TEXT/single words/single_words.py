#      |               |                                 |
                
#                  |                                                |            |                                   |                               |                           |                               |                           |                               |                                |                               |
#           |                                  |                                     |
                
#                  |                     |                                                     |                                   |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#   |                          |                       |                    |
#           |                                    |                                         |     |                    |                                    | |     |                    |                                    | |     |                    |                                    |      |     |                                                        |
#      |                        |                                 |      |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                       |                    |
                
#                      |                                                |      |                                   |                               |                         |                               |                         |                               |                              |                               |
#           |                                   |                               |                   |                                |                       |                    |          |                                |                       |                    |          |                                |                       |                    |               |                                |                                        |
                
#                  |                     |
#   |                                |                       |                    |            |                                |                       |                    |     |                                |                       |                    |     |                                |                       |                              |                                |
#           |                               |                                         |                              |                       |                    |                           |                       |                    |                           |                       |                    |                                |                       |                    |
                
#   |         |                                   PRESENTATION                                                |                                |                    |   |                                |                    |   |                                |                    |        |                                |                    |
#                                                                                                                               |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#                |                             /                 \                          |                                                                              |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
                
#        |                                This script allows Blender to 
                
#                           generate one or multiples words using or not some fonts        |                                           |               |                                           |               |                                           |                    |                                           |
                
#                           /                      |    v    |                    \
#                https://github.com/SECRET-GUEST/animation/tree/blender/Object%20generation/TEXT
#                                   |                                |                                          |      |                                |                                          |      |                                |                                          |           |                                |
#                                                                                                    |                                                                 |                      |                     |                       |                      |                     |                       |                      |                     |                            |
#           
#      |                  !      |                                   |     |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                           |
#                                |                                   |     |                  
#                   |            |                   Anyway          !                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |
                
#              |                      |                 have                                                 |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                                           |
                

#                 |                                  FUN         |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                                                      |
                
#                                                         =)
                
#
#                                |                      or                                       |                                                            |                    |                |                       |                    |                |                       |                    |                    |                                           |
                

#              |                              |       DIE ! ! !        |                       |                            |                |                       |                    |                |                       |                    |                    |                                           |#      |                        |                                         |                                |
                
#
#                                                     !                                       |                                |                    |  |                                |                    |  |                                |                    |       |                                |                    |
                
#      |               |                                 !
                
#                  |                                                |            |                                   |                               |                           |                               |                           |                               |                                |                               |
#           |                                  !                                     |
                
#                  |                     |                                                     |                                   |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#   |                          |                       |                    !
#           |                                    |                                         |     |                    |                                    | |     |                    |                                    | |     |                    |                                    |      |     |                    |                                    |
              
#_ _  _ ____ ___ ____ _    _    ____ ___ _ ____ _  _
#| |\ | [__   |  |__| |    |    |__|  |  | |  | |\ |
#| | \| ___]  |  |  | |___ |___ |  |  |  | |__| | \|
import bpy

#____ ____ ___ ___ _ _  _ ____ ____ 
#[__  |___  |   |  | |\ | | __ [__  
#___] |___  |   |  | | \| |__] ___] 
                                   
#OPENING | https://www.youtube.com/watch?v=qmk3Rri0jsQ&ab_channel=SECRETGUEST


font_size = 1.0

in_collection = "Texts" # Change it to generate in a new or previous collection

# To add only one word use a , ex: ("Word",) 
# if you don't it will generate letters by objects : W o r d
words = ("word1", "word2", "word3")  

# Example font path: '/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf'
font_path = None # Set fonts or use default with None
# Grep font path on linux with "fc-list | grep "FontName"


#___  ____ _ _ _ ____ ____    ___  _    ____ _  _ ___
#|__] |  | | | | |___ |__/    |__] |    |__| |\ |  |
#|    |__| |_|_| |___ |  \    |    |___ |  | | \|  |
          

def create_text_objects(word_list, font_size, font_path=None):
    # Check if the 'texts' collection exists, if not, create it
    if "texts" not in bpy.data.collections:
        new_collection = bpy.data.collections.new(in_collection)
        bpy.context.scene.collection.children.link(new_collection)
    else:
        new_collection = bpy.data.collections[in_collection]

    for i, word in enumerate(word_list):
        # Create a new text object for each word
        bpy.ops.object.text_add(location=(i * 2, 0, 0))  # Adjust location if needed
        text_obj = bpy.context.object
        text_obj.data.body = word

        # Rename the object to match the word
        text_obj.name = word

        # Set font size
        text_obj.data.size = font_size

        # Set custom font if a font path is provided
        if font_path:
            try:
                font = bpy.data.fonts.load(font_path)
                text_obj.data.font = font
            except:
                print("Error loading font. Using default font.")

        # Move the text object to the 'texts' collection
        # Remove from all other collections
        for collection in text_obj.users_collection:
            collection.objects.unlink(text_obj)
        
        # Link the text object to the 'texts' collection
        new_collection.objects.link(text_obj)



create_text_objects(words, font_size, font_path)
