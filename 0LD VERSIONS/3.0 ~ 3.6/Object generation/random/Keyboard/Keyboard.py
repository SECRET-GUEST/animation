#         ████████     ██████
#        █░░░░░░░░██_██░░░░░░█
#       █░░░░░░░░░░░█░░░░░░░░░█
#      █░░░░░░░███░░░█░░░░░░░░░█
#      █░░░░███░░░███░█░░░████░█
#    █░░░██░░░░░░░░███░██░░░░██
#   █░░░░░░░░░░░░░░░░░█░░░░░░░░███
#   █░░░░░░░░░░░░░██████░░░░░████░░█
#   █░░░░░░░░░█████░░░████░░██░░██░░█
#  ██░░░░░░░███░░░░░░░░░░█░░░░░░░░███
# █░░░░░░░░░░░░░░█████████░░█████████
#█░░░░░░░░░░█████ ████   ████ █████ █
#█░░░░░░░░░░█      █ ███   █   ███ █ █
#█░░░░░░░░░░░░█   ████ ████    ██ ████
#░░░░░░░░░░░░░█████████░░░████████░░░█
#░░░░░░░░░░░░░░░░█░░░░░█░░░░░░░░░░░░█
#░░░░░░░░░░░░░░░░░░░░██░░░░█░░░░░░██
#░░░░░░░░░░░░░░░░░░██░░░░░░░███████
#░░░░░░░░░░░░░░░░██░░░░░░░░░░█░░░░░█                                            _____                                 _____                                            _____                                                   _____
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                                          /\    \                               /\    \                                          /\    \                                                 /\    \
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                      ::                 /::\    \                             /::\    \                                        /::\____\                                               /::\____\
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█                                        /::::\    \                           /::::\    \           :::         ::           ::: ::/    /                         :                   :: ::/    /
#░░░░░░░░░░░█████████░░░░░░░░░░░░░░██                                       /::::::\    \                         /::::::\    \                               ::: : :::/    /                                              /:::/    /
#░░░░░░░░░░█▒▒▒▒▒▒▒▒███████████████▒▒█                                     /:::/\:::\    \                    :: ::::/\:::\    \                                  /:::/    /                                              /:::/    /
#░░░░░░░░░█▒▒███████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█                                    /:::/__\:::\    \                     /:::/__\:::\    \                                /:::/    /                                            :::: :/____/
#░░░░░░░░░█▒▒▒█▓▓▓▓██████████████████                                    /::::\   \:::\    \                   /::::\   \:::\    \                              /:::/    /                                              /::::\    \
#░░░░░░░░░██▒▒█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                       /::::::\   \:::\    \                 /::::::\   \:::\    \                            /:       /      _____                                   /::::::\    \   _____
#░░░░░░░░░░█▒▒█▓█████████████████ ████                                 /:::/\:::\   \:::\ ___\               /:::/\:::\   \:::\____\                          /:::/____/      /\    \                                 /:::/\:::\    \ /\    \
#░░░░░░░░░░█▒▒██▓▓▒▓▒▓▒▓▒▒▒▒▒▒▒▒▓█▓▒▒▒█                               /:::/__\:::\   \:::|    |             /:::/  \:::\   \:::|    |                         :::|    /      /::\____\                        ::::::: :::/ : :::\    /::\____\
#░░░░░░░░░█▒▒████████▓▒███▓██▒▒▒▒▒▒▒▒▒█                  :            \:::\   \:::\  /:::|____|             \::/   |::::\  /:::|____|                      : :: :|____\     /:::/    /                               \::/    \:::\: ::::/    /
#░░░░░░░░░█▒▒▒▒▒▒▒▒▒█████████████▓█▓██                                 \:::\   \:::\/:::/    /               \/____|:::::\/:::/    /                          \:::\    \   /:::/    /                                 \/____/: :::\/:::/    /
#░░░░░░░░░░████████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█                                  \:::\   \::::::/    /                      |:::::::::/    /                            \:::\   :: : ::/    /                                 :  :  : : :::::::/    /
#░░░░░░░░░░░░░░░░░░██████████████████                                    \:::\   \::::/    /          :  :         |::|\::::/    /           ::                 \:::\    /:::/    /               ::::                          \::       /
#░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█            ::                           \:::\  /:::/    /                      :: ::| \::/____/                                \:::\__/:::/    /                                              /:::/    /
#██░░░░░░░░░░░░░░░░░░░░░░░░░░░██                                           \:::\/:::/    /                         |::|  ~|                                       \::::::::/    /                                             : :::/    /
#▓██░░░░░░░░░░░░░░░░░░░░░░░░██                                              \::::::/    /                          |::|   |                                        \::::::/    /                                              /:::/    /
#▓▓▓███░░░░░░░░░░░░░░░░░░░░█                                                 \::::/    /                           \::|   |                                         \::::/    /                              ::: :           /:::/    /
#▓▓▓▓▓▓███░░░░░░░░░░░░░░░██                                 :                 \::/____/            :                \:|   |               :    ::::                  \::/____/                                               \::/    /
#▓▓▓▓▓▓▓▓▓███████████████▓▓█                                                   ⠋                                     \|___|                                           ⠩                                                      \/____/
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓██
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                                                                                                                                                                                                                               |                                                                    |                                      |
#▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█                                                                    |                                                                                                             |
#______________________________                                                                                                                       |                                                                                                                      |                                                                                                                                              |                    |
#___________________________
#_ ______ _____ _________
#/            /                                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                       |                    |
                
#       \                          |                                |                                               |  |                                          |                    |                                          |                       |                    |  |                                           |                    |        |                    |                              |
                

#     |               |                                 |
                
#                 |                                                |            |                                   |                               |                           |                               |                           |                               |                                |                               |
#          |                                  |                                     |
                
#                 |                     |                                                     |                                   |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#  |                          |                       |                    |
#          |                                    |                                         |     |                    |                                    | |     |                    |                                    | |     |                    |                                    |      |     |                                                        |
#     |                        |                                 |      |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                       |                    |
                
#                     |                                                |      |                                   |                               |                         |                               |                         |                               |                              |                               |
#          |                                   |                               |                   |                                |                       |                    |          |                                |                       |                    |          |                                |                       |                    |               |                                |                                        |
                
#                 |                     |
#  |                                |                       |                    |            |                                |                       |                    |     |                                |                       |                    |     |                                |                       |                              |                                |
#          |                               |                                         |                              |                       |                    |                           |                       |                    |                           |                       |                    |                                |                       |                    |
                
#  |         |                                   PRESENTATION                                                |                                |                    |   |                                |                    |   |                                |                    |        |                                |                    |
#                                                                                                                              |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#               |                             /                 \                          |                                                                              |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
                
#       |                                This script allows Blender to 
                
#                                generate a keyboard fully ajustable. There are           |                                           |               |                                           |               |                                           |                    |                                           |
                
#                          /                      |    v    |                    \
#                      settings all along the script you just have to read the comments
#                                  |                                |                                          |      |                                |                                          |      |                                |                                          |           |                                |
#                                                                                                   |                                                                 |                      |                     |                       |                      |                     |                       |                      |                     |                            |
#          
#     |                  !      |                                   |     |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                           |
#                               |                                   |     |                  
#                  |            |                   Anyway          !                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |
                
#             |                      |                 have                                                 |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                     |                                           |
                

#                |                                  FUN         |                        |                                         |                                |                       |                    |                |                       |                    |                |                       |                    |                    |                                                                      |
                
#                                                        =)
                
#
#                               |                      or                                       |                                                            |                    |                |                       |                    |                |                       |                    |                    |                                           |
                

#             |                              |       DIE ! ! !        |                       |                            |                |                       |                    |                |                       |                    |                    |                                           |#     |                        |                                         |                                |
                
#
#                                                    !                                       |                                |                    |  |                                |                    |  |                                |                    |       |                                |                    |
                
#     |               |                                 !
                
#                 |                                                |            |                                   |                               |                           |                               |                           |                               |                                |                               |
#          |                                  !                                     |
                
#                 |                     |                                                     |                                   |                               |     |                                   |                               |     |                                   |                               |          |                                   |                               |
#  |                          |                       |                    !
#          |                                    |                                         |     |                    |                                    | |     |                    |                                    | |     |                    |                                    |      |     |                    |                                    |
             
#_ _  _ ____ ___ ____ _    _    ____ ___ _ ____ _  _
#| |\ | [__   |  |__| |    |    |__|  |  | |  | |\ |
#| | \| ___]  |  |  | |___ |___ |  |  |  | |__| | \|

#You don't have to import with pip, just paste the code in blender               


import bpy








#____ ____ ___ ___ _ _  _ ____ ____ 
#[__  |___  |   |  | |\ | | __ [__  
#___] |___  |   |  | | \| |__] ___] 
                                   
 #Here you can change the main values if you need , but there are more in the script
  

#Delete all existing objects in the scene (uncomment if you need)
#bpy.ops.object.select_all(action='SELECT')
#bpy.ops.object.delete(use_global=False)

collection_name = "Keyboard"

#Key dimensions
KEY_WIDTH = 2
KEY_HEIGHT = 1

#Spacing between keys
SPACING = 0

#Base depth
BASE_DEPTH = 0.3
#Padding around keys
PADDING = 0.5






#___  ____ _ _ _ ____ ____    ___  _    ____ _  _ ___
#|__] |  | | | | |___ |__/    |__] |    |__| |\ |  |
#|    |__| |_|_| |___ |  \    |    |___ |  | | \|  |
                

#OPENING | https://www.youtube.com/watch?v=_85LaeTCtV8 :3
                


#Function creates a key object at the specified location and with name and dimensions
def create_key(x, y, width, height, key_name):

    #first add a cube then move it to the specified location.
    bpy.ops.mesh.primitive_cube_add(size=1, enter_editmode=False, align='WORLD', location=(x+1, y+1, 0))

    #Get a reference to that cube and name it
    key = bpy.context.active_object
    key.name = key_name #we set here a value to name all keys

    #Set the scale of the object based on the specified dimensions, change it by yours to adapt keys
    key.scale[0] = width / 1.1
    key.scale[1] = height / 1.5
    key.scale[2] = 0.05

    #Return the key object.
    return key


#Function creates the base for the keyboard
def create_base(width, height, depth):

    bpy.ops.mesh.primitive_cube_add(size=1, enter_editmode=False, align='WORLD', location=(width/2, height/2, -depth/2))

    base = bpy.context.active_object
    base.name = "Base"

    base.scale[0] = width +1
    base.scale[1] = height+.1
    base.scale[2] = depth 

    return base


#Function to                            .                            .                                   .                                                                                                                                                                                                                                                                                                                                                   create the keyboard
def create_keyboard():
    keyboard = []

    #Key dimensions
    key_width = KEY_WIDTH
    key_height = KEY_HEIGHT
    spacing = SPACING

    #Create keys
    layout = [
        ["Esc"] + ["F" + str(i) for i in range(1, 13)],
        ["1", "2", "3", "4", "5", "6", "7", "8", "9", "0", "-", "=", "Backspace"],
        ["Tab"] + ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P", "[", "]", "Enter"],
        ["Caps Lock"] + ["A", "S", "D", "F", "G", "H", "J", "K", "L", ";", "'", "#"],
        ["Shift"] + ["Z", "X", "C", "V", "B", "N", "M", ",", ".", "/", "Shift"],
        ["Ctrl", "Fn", "Win", "Alt", "Space", "Alt", "Menu", "Ctrl"]
    ]

    custom_sizes = {
        "Esc": (1.25, 1),
        "Tab": (1.5, 1),
        "Caps Lock": (1.75, 1),
        "Shift": (2.25, 1),
        "Ctrl": (1.5, 1),
        "Fn": (1.25, 1),
        "Win": (1.25, 1),
        "Alt": (1.25, 1),
        "Space": (13, 1),
        "Menu": (1.25, 1),
        "Enter": (2, 2),
        "Backspace": (2, 1)
    }


    #Initialize variables to store minimum and maximum x and y values
    min_x = float('inf')
    max_x = float('-inf')
    min_y = float('inf')
    max_y = float('-inf')
    


    #Loop through each row and column in the layout to create key objects
    for row, keys in enumerate(layout):

        #Initialize the current row
        x_offset = 0

        #Loop through each key in the current row
        for col, key_name in enumerate(keys):

            #Get the width and height of the current key from the custom_sizes dictionary or use default values
            width = custom_sizes.get(key_name, (key_width, key_height))[0]
            height = custom_sizes.get(key_name, (key_width, key_height))[1]

            #Calculate the x and y positions for the current key
            x = x_offset + width / 2
            y = row * (key_height + spacing)

            #Create a new key object with the calculated position and dimensions then add new key object to the keyboard list
            key = create_key(x, y, width, height, key_name)
            keyboard.append(key)

            #Update the x offset for the next key in the current row
            x_offset += width + spacing
    
            #Update the minimum and maximum x and y values based on the position and dimensions of the key
            min_x = min(min_x, x - width / 2)
            max_x = max(max_x, x + width / 2)
            min_y = min(min_y, y - height / 2)
            max_y = max(max_y, y + height / 2)
    
    #Calculate the width and height of the base object based on the minimum and maximum x and y values and the PADDING constant
    base_width = max_x - min_x + 2 * PADDING
    base_height = max_y - min_y + 2 * PADDING
    

    #Create base
    base = create_base(base_width, base_height, BASE_DEPTH)

    #Create a new collection named with the name of the variable in the settings
    keyboard_collection = bpy.data.collections.new(collection_name)
    bpy.context.scene.collection.children.link(keyboard_collection)

    #Add keys and base to the new collection (link to the collection then unlink to avoid doubles)
    for key in keyboard:
        keyboard_collection.objects.link(key)
        bpy.context.collection.objects.unlink(key)
        
    keyboard_collection.objects.link(base)
    bpy.context.collection.objects.unlink(base)
    
    return keyboard_collection


#____ ____ ____ _  _ ____ ___    _    ____ _  _ _  _ ____ _  _
#|__/ |  | |    |_/  |___  |     |    |__| |  | |\ | |    |__|
#|  \ |__| |___ | \_ |___  |     |___ |  | |__| | \| |___ |  |
                
#ENDING | https://www.youtube.com/watch?v=CgZVrvQZB6U&ab_channel=SECRETGUEST :3

keyboard_collection = create_keyboard()